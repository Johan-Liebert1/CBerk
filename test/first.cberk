include "../examples/include/std.cberk"

def AF_INET: int16 = 2;
def S_ADDR: int32 = 0;
def PORT: int16 = 5000;
def PAD: int = 0;

def SOCK_STREAM: int = 1;

def SOCKET_SYSCALL: int = 41;
def READ_SYSCALL: int = 0;
def WRITE_SYSCALL: int = 1;
def OPEN_SYSCALL: int = 2;
def CLSOE_SYSCALL: int = 3;
def ACCEPT_SYSCALL: int = 43;
def BIND_SYSCALL: int = 49;
def LISTEN_SYSCALL: int = 50;

def STDOUT: int = 1;

struct sockaddr_in {
    sa_prefix: int16
    sin_port: int16,
    s_addr: int32,
    pad: int,
};

mem serveraddr_mem 16

fun strlen_cstr(string: *char) -> int {
    def i: int = 0;

    loop {
        if *(string + i) == 0 {
            break;
        }

        i += 1;
    }

    return i;
}

fun strlen(string: *str) -> int {
    def len: *str = string + 8;
    def length: int = *(len as *int);
    return length;
}

fun main() {
    def hel: str = "hello_world\0";

    def len: int = strlen2(&hel);

    write("len = ", len)
}

main()
